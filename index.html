<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Fixing Search Ultimate</title>
    <style>
        body, html { margin:0; padding:0; width:100%; height:100%; overflow:hidden; background:#050505; font-family:sans-serif; }
        #loader { display:flex; flex-direction:column; justify-content:center; align-items:center; height:100vh; color:#00e5ff; }
        .ring { border:4px solid #1a1a1a; border-top:4px solid #00e5ff; border-radius:50%; width:50px; height:50px; animation:spin 1s linear infinite; }
        @keyframes spin { 100% { transform:rotate(360deg); } }
        iframe { width:100%; height:100%; border:none; display:none; }
    </style>
</head>
<body>
    <div id="loader"><div class="ring"></div><p>Sistem Çözülüyor...</p></div>
    <iframe id="finalFrame"></iframe>

    <script>
    async function sitemiAc() {
        try {
            const [kRes, dRes] = await Promise.all([
                fetch("obfexkey.obfex"), 
                fetch("obfexfixingsearch.txt")
            ]);

            const map = JSON.parse(await kRes.text());
            const dataStr = (await dRes.text()).trim();
            
            let tersMap = {};
            for (let k in map) { tersMap[map[k]] = k; }
            const keys = Object.keys(tersMap).sort((a,b) => b.length - a.length);
            
            let html = "";
            let i = 0;
            while (i < dataStr.length) {
                let found = false;
                for (let k of keys) {
                    if (dataStr.startsWith(k, i)) {
                        let h = tersMap[k];
                        html += (h === "fix0" ? " " : (h === "fix29" ? "\n" : h));
                        i += k.length;
                        found = true;
                        break;
                    }
                }
                if (!found) { html += dataStr[i]; i++; }
            }

            const frame = document.getElementById("finalFrame");
            const loader = document.getElementById("loader");
            
            // İçeriği iframe'e basıyoruz (Tuşların çalışması için en sağlam yol)
            const frameDoc = frame.contentWindow.document;
            frameDoc.open();
            frameDoc.write(html);
            frameDoc.close();

            loader.style.display = "none";
            frame.style.display = "block";

        } catch (e) {
            document.getElementById("loader").innerHTML = "Hata: " + e.message;
        }
    }
    sitemiAc();
    </script>
</body>
</html>
