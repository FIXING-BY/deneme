<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fixing Search</title>
    <style>
        /* Siten yüklenene kadar görünecek olan siyah arka plan ve yükleme animasyonu */
        body { 
            margin: 0; 
            background: #050505; 
            color: white; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            overflow: hidden; 
            font-family: sans-serif;
        }
        .loader {
            text-align: center;
        }
        .ring {
            width: 50px; height: 50px;
            border: 3px solid #1a1a1a;
            border-top: 3px solid #00e5ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 10px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        #obfex-tag { position: fixed; bottom: 10px; right: 10px; font-size: 10px; opacity: 0.2; }
    </style>
</head>
<body>

    <div id="root">
        <div class="loader">
            <div class="ring"></div>
            <p>Sistem Yükleniyor...</p>
        </div>
    </div>
    
    <div id="obfex-tag">protected by obfex</div>

    <script>
    async function baslat() {
        try {
            // 1. Dosyaları çekiyoruz
            const [sifreliMetin, anahtarRaw] = await Promise.all([
                fetch("obfexfixingsearch.txt").then(r => r.text()),
                fetch("obfexkey.obfex").then(r => r.text())
            ]);

            // 2. Anahtarı çözülebilir hale getiriyoruz
            const map = JSON.parse("{" + anahtarRaw + "}");
            let tersMap = {};
            for (let harf in map) { tersMap[map[harf]] = harf; }

            // 3. Şifreyi çözüyoruz (En uzun eşleşmeden başlayarak)
            const siraliAnahtarlar = Object.keys(tersMap).sort((a, b) => b.length - a.length);
            let cozulmusHtml = "";
            let i = 0;

            while (i < sifreliMetin.length) {
                let bulundu = false;
                for (let anahtar of siraliAnahtarlar) {
                    if (sifreliMetin.startsWith(anahtar, i)) {
                        cozulmusHtml += tersMap[anahtar];
                        i += anahtar.length;
                        bulundu = true;
                        break;
                    }
                }
                if (!bulundu) {
                    cozulmusHtml += sifreliMetin[i];
                    i++;
                }
            }

            // 4. Çözülen HTML'i sayfaya basıyoruz
            const root = document.getElementById("root");
            root.innerHTML = cozulmusHtml;

            // 5. KRİTİK: İçerikteki scriptleri elle canlandırıyoruz
            root.querySelectorAll("script").forEach(eskiScript => {
                const yeniScript = document.createElement("script");
                Array.from(eskiScript.attributes).forEach(attr => yeniScript.setAttribute(attr.name, attr.value));
                yeniScript.appendChild(document.createTextNode(eskiScript.innerHTML));
                document.body.appendChild(yeniScript);
                eskiScript.remove();
            });

            // Yükleme stilini kaldırıp asıl site stilini aktif ediyoruz
            document.body.style.display = "block";
            document.body.style.height = "auto";
            document.body.style.overflow = "visible";

        } catch (hata) {
            console.error("Yükleme Hatası:", hata);
            document.getElementById("root").innerHTML = "Sistem yüklenirken bir hata oluştu.";
        }
    }

    baslat();
    </script>
</body>
</html>
